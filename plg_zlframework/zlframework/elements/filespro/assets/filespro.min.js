(function(a){var d=function(b){this.options=a.extend({},this.options,b);this.events={}};d.prototype=a.extend(d.prototype,a.zlux.Main.prototype,{name:"ElementFilespro",options:{root:"",extensions:"",storage:"",fileMode:"",max_file_size:"",title:""},events:{},initialize:function(b,c){this.options=a.extend({},a.zlux.Main.prototype.options,this.options,c);var f=this;f.element=b;b.on("click","p.add a",function(){f.apply(a("input.filespro",b).add("input.mediapro-element",b))});f.apply(a("input.filespro",
b).add("input.mediapro-element",b))},apply:function(b){var c=this;a.zlux.assets.load("files").done(function(){var f=a.zlux.filesPreview();b.each(function(b,d){var g=a(d);if(!a(d).data("initialized")){var e="filespro-element-"+b,h=g.closest(".row").addClass("zl-bootstrap"),l=g.hasClass("image-element")?!0:!1;g.attr("id",e);e=a("span.zlux-x-filedata",h).data("zlux-storage");c.dialogTrigger=a('<a title="'+c.options.title+'" class="btn btn-mini zlux-btn-edit" href="#"><i class="icon-edit"></i></a>').appendTo(h);
c.dialogTrigger.zlux("filesDialogManager",{extensions:c.options.extensions,max_file_size:c.options.max_file_size,title:c.options.title,storage:e.engine,storage_params:e,root:e.root}).on("zlux.ObjectSelected",function(b,d,e){if("files"!=c.options.fileMode||"file"==e.type)if("folders"!=c.options.fileMode||"folder"==e.type)b=d.getFullPath(e.name),g.val(b).trigger("change"),e.path=b,a(".zlux-preview",h).remove(),h.append(f.renderPreviewDOM(e,l))});e=a("span.zlux-x-filedata",h).data("zlux-data");!a.isEmptyObject(e)&&
g.val()&&(e.path=g.val(),h.append(f.renderPreviewDOM(e,l)));a('<i class="icon-remove zlux-x-cancel-btn" />').insertAfter(g).on("click",function(){g.val("");a(".zlux-preview",h).remove()})}g.data("initialized",!0)})})}});a.fn[d.prototype.name]=function(){var b=arguments,c=b[0]?b[0]:null;return this.each(function(){var f=a(this);if(d.prototype[c]&&f.data(d.prototype.name)&&"initialize"!=c)f.data(d.prototype.name)[c].apply(f.data(d.prototype.name),Array.prototype.slice.call(b,1));else if(!c||a.isPlainObject(c)){var k=
new d;d.prototype.initialize&&k.initialize.apply(k,a.merge([f],b));f.data(d.prototype.name,k)}else a.error("Method "+c+" does not exist on jQuery."+d.name)})}})(jQuery);